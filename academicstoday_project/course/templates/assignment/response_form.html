<script>
/**
 *  Function sends AJAX code to tell the controller to either set the
 *  particular question as selected or not for the option.
 */
function ajax_submit_response_assignment_answer(div_id, question_num)
{
    // create a FormData Object using your form dom element
    var data = new FormData();
    data.append('csrfmiddlewaretoken', '{{ csrf_token }}');
    data.append('assignment_id', {{ assignment.id }});
    data.append('student_id', {{ user.id }});
    data.append('course_id', {{ assignment.course_id }});
    data.append('question_num', question_num);
    
    // Get the response and append it to the form.
    var text = $(div_id).val();
    data.append('response', text);
    
    jQuery.ajax({
        url: 'submit_response_assignment_answer',
        data: data,
        cache: false,
        contentType: false,
        processData: false,
        type: 'POST',
        success: function(result){
            if (result.status != 'success') // Print errors.
            {
                alert(result.message);
            }
        }
    });
}
</script>
<form id="assignment_form" name="assignment_form">
    {% for question in questions %}
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">Q{{ question.question_num }}: {{ question.title }}</h3>
        </div>
        <div id="panel-body" class="panel-body">
            <p>{{ question.description }}</p>
            <textarea id="Q{{ question.question_num }}_response"
                    name="Q{{ question.question_num }}_response"
                    cols="105"
                    rows="5"
              onfocusout="ajax_submit_response_assignment_answer('#Q{{ question.question_num }}_response', {{ question.question_num }});"></textarea>
        </div>
    </div>
    {% empty %}
    <strong>Missing Questions!</strong> It appears we're missing the questions!
    {% endfor %}
</form>